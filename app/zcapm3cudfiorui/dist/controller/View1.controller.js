sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/m/MessageBox","sap/ui/model/json/JSONModel"],(e,t,n,r)=>{"use strict";return e.extend("zcapm3cudfiorui.controller.View1",{onInit:function(){},_model:function(){return this.getView().getModel()},_getSelectedOrderCtx:function(){const e=this.byId("tblOrders");const t=e.getSelectedItem();return t?t.getBindingContext():null},_getSelectedItemCtx:function(){const e=this.byId("tblItems");const t=e.getSelectedItem();return t?t.getBindingContext():null},_enableOrderButtons:function(e){this.byId("btnUpdateOrder").setEnabled(e);this.byId("btnDeleteOrder").setEnabled(e);this.byId("btnCreateItem").setEnabled(e);this.byId("btnUpdateItem").setEnabled(false);this.byId("btnDeleteItem").setEnabled(false)},onOrderSelectionChange:function(){const e=this.byId("tblOrders").getSelectedItem();const t=this.byId("tblItems");if(!e){t.unbindItems();this._enableOrderButtons(false);return}const n=e.getBindingContext();const r=n&&n.getPath();if(!r){sap.m.MessageBox.error("No context path for selected order.");return}t.bindItems({path:`${r}/items`,template:t.getItems()[0]?.clone?t.getItems()[0].clone():undefined,parameters:{$$ownRequest:true}});this._enableOrderButtons(true)},onItemSelectionChange:function(){const e=!!this._getSelectedItemCtx();this.byId("btnUpdateItem").setEnabled(e);this.byId("btnDeleteItem").setEnabled(e)},onCreateOrder:function(){const e=this.byId("inpCustomer").getValue();const r=this.byId("inpStatus").getValue()||"NEW";const s=this.byId("inpTotal").getValue();const i=s?Number(s):0;if(!e){n.error("Customer ID is required");return}const o=this._model();const d=o.bindList("/SalesOrders");const a=d.create({customerID:e,status:r,total:i});a.created().then(()=>{t.show("Order created");this.byId("tblOrders").getBinding("items").refresh()}).catch(e=>n.error("Create failed: "+(e.message||e)))},onUpdateOrder:function(){const e=this._getSelectedOrderCtx();if(!e)return n.information("Select an order");const r=this.byId("inpStatus").getValue();const s=this.byId("inpTotal").getValue();if(!r&&!s){return n.information("Enter Status and/or Total to update")}if(r)e.setProperty("status",r);if(s)e.setProperty("total",Number(s));t.show("Order updated")},onDeleteOrder:function(){const e=this._getSelectedOrderCtx();if(!e)return n.information("Select an order");n.confirm("Delete selected order (and its items)?",{onClose:r=>{if(r!==n.Action.OK)return;e.delete().then(()=>t.show("Order deleted")).catch(e=>n.error("Delete failed: "+(e.message||e)))}})},onCreateItem:function(){const e=this._getSelectedOrderCtx();if(!e)return n.information("Select an order first");const r=this.byId("inpProduct").getValue();const s=this.byId("inpQty").getValue();const i=this.byId("inpPrice").getValue();const o=Number(s||0);const d=Number(i||0);if(!r)return n.error("Product ID is required");if(!(o>0))return n.error("Quantity must be > 0");if(d<0)return n.error("Price must be >= 0");const a=this._model();const c=a.bindList(e.getPath()+"/items");const l=c.create({productID:r,quantity:o,price:d});l.created().then(()=>{t.show("Item added");this.byId("tblItems").getBinding("items").refresh()}).catch(e=>n.error("Add item failed: "+(e.message||e)))},onUpdateItem:function(){const e=this._getSelectedItemCtx();if(!e)return n.information("Select an item");const r=this.byId("inpQty").getValue();const s=this.byId("inpPrice").getValue();if(!r&&!s)return n.information("Enter Quantity and/or Price to update");if(r)e.setProperty("quantity",Number(r));if(s)e.setProperty("price",Number(s));t.show("Item updated")},onDeleteItem:function(){const e=this._getSelectedItemCtx();if(!e)return n.information("Select an item");n.confirm("Delete the selected item?",{onClose:r=>{if(r!==n.Action.OK)return;e.delete().then(()=>t.show("Item deleted")).catch(e=>n.error("Delete item failed: "+(e.message||e)))}})}})});
//# sourceMappingURL=View1.controller.js.map